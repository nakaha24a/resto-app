{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { create } from \"zustand\";\n// 環境変数、またはデフォルトのIPアドレス（学校用に合わせてHTTPS/443にしています）\nconst API_BASE_URL = process.env.REACT_APP_API_BASE_URL || \"https://localhost:443\";\n// オプション配列をソートして一意なキーを作成するヘルパー\nconst generateOptionsKey = options => {\n  if (!options || options.length === 0) return \"\";\n  const sorted = [...options].sort((a, b) => {\n    const nameA = typeof a === \"string\" ? a : a.name;\n    const nameB = typeof b === \"string\" ? b : b.name;\n    return nameA.localeCompare(nameB);\n  });\n  return JSON.stringify(sorted);\n};\nconst useCartStore = create((set, get) => ({\n  cart: [],\n  orders: [],\n  menuData: null,\n  menuLoading: false,\n  error: null,\n  fetchMenu: async () => {\n    set({\n      menuLoading: true,\n      error: null\n    });\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/menu`);\n      if (!response.ok) throw new Error(\"メニューの読み込みに失敗しました\");\n      const data = await response.json();\n      set({\n        menuData: data,\n        menuLoading: false\n      });\n    } catch (err) {\n      set({\n        error: err.message,\n        menuLoading: false\n      });\n    }\n  },\n  fetchMenuData: async _arg => {\n    await get().fetchMenu();\n  },\n  fetchOrders: async tableNumber => {\n    try {\n      // サーバーから「会計済み」以外の注文だけを取得\n      const response = await fetch(`${API_BASE_URL}/api/orders?tableNumber=${tableNumber}`);\n      if (response.ok) {\n        const currentOrders = await response.json();\n        set({\n          orders: currentOrders\n        });\n      }\n    } catch (err) {\n      console.error(\"注文履歴の取得に失敗:\", err);\n    }\n  },\n  addToCart: (item, quantity, options = []) => {\n    set(state => {\n      const basePrice = Number(item.price) || 0;\n      const optionsPrice = options.reduce((sum, opt) => {\n        if (typeof opt === \"object\" && opt !== null && \"price\" in opt) {\n          return sum + (Number(opt.price) || 0);\n        }\n        return sum;\n      }, 0);\n      const unitPrice = basePrice + optionsPrice;\n      const currentOptionsKey = generateOptionsKey(options);\n      const existingIndex = state.cart.findIndex(c => c.id === item.id && generateOptionsKey(c.selectedOptions || []) === currentOptionsKey);\n      if (existingIndex > -1) {\n        const newCart = [...state.cart];\n        newCart[existingIndex].quantity += quantity;\n        newCart[existingIndex].totalPrice = unitPrice * newCart[existingIndex].quantity;\n        return {\n          cart: newCart\n        };\n      } else {\n        const newItem = {\n          ...item,\n          quantity,\n          selectedOptions: options,\n          totalPrice: unitPrice * quantity\n        };\n        return {\n          cart: [...state.cart, newItem]\n        };\n      }\n    });\n  },\n  removeFromCart: index => {\n    set(state => ({\n      cart: state.cart.filter((_, i) => i !== index)\n    }));\n  },\n  updateCartItemQuantity: (index, quantity) => {\n    set(state => {\n      const newCart = [...state.cart];\n      if (quantity <= 0) {\n        return {\n          cart: newCart.filter((_, i) => i !== index)\n        };\n      }\n      const item = newCart[index];\n      const basePrice = Number(item.price) || 0;\n      const optionsPrice = (item.selectedOptions || []).reduce((sum, opt) => {\n        if (typeof opt === \"object\" && opt !== null && \"price\" in opt) {\n          return sum + (Number(opt.price) || 0);\n        }\n        return sum;\n      }, 0);\n      newCart[index].quantity = quantity;\n      newCart[index].totalPrice = (basePrice + optionsPrice) * quantity;\n      return {\n        cart: newCart\n      };\n    });\n  },\n  clearCart: () => set({\n    cart: []\n  }),\n  /* ★ここが最重要修正ポイント！\r\n   サーバーのDBを更新しないとKDSから消えないので、必ずfetchを行います。\r\n  */\n  checkout: async tableNumber => {\n    try {\n      // 1. サーバーに「このテーブルは会計済みにして！」と頼む\n      const response = await fetch(`${API_BASE_URL}/api/checkout`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          tableNumber\n        })\n      });\n      if (!response.ok) throw new Error(\"Checkout failed\");\n\n      // 2. サーバーでの更新が成功したら、タブレットの画面もクリアする\n      set({\n        cart: [],\n        orders: []\n      });\n    } catch (error) {\n      console.error(\"Checkout error:\", error);\n      alert(\"通信エラーが発生しました。もう一度試してください。\");\n    }\n  },\n  placeOrder: async tableNumber => {\n    const {\n      cart\n    } = get();\n    if (cart.length === 0) return null;\n    try {\n      const response = await fetch(`${API_BASE_URL}/api/orders`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          tableNumber,\n          items: cart\n        })\n      });\n      if (!response.ok) throw new Error(\"注文に失敗しました\");\n      const newOrder = await response.json();\n      set({\n        cart: []\n      });\n      await get().fetchOrders(tableNumber);\n      return newOrder;\n    } catch (err) {\n      set({\n        error: err.message\n      });\n      return null;\n    }\n  },\n  callStaff: async tableNumber => {\n    try {\n      await fetch(`${API_BASE_URL}/api/call`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          tableNumber\n        })\n      });\n      await get().fetchOrders(tableNumber);\n    } catch (err) {\n      console.error(\"スタッフ呼び出しエラー\", err);\n    }\n  }\n}));\nexport const useCartTotalAmount = () => {\n  _s();\n  const cart = useCartStore(state => state.cart);\n  return cart.reduce((sum, item) => sum + (item.totalPrice || 0), 0);\n};\n_s(useCartTotalAmount, \"L4Q9CYCqIhEZ8aSQ0u+u5YP3sD0=\", false, function () {\n  return [useCartStore];\n});\nexport const useTotalBillAmount = () => {\n  _s2();\n  const orders = useCartStore(state => state.orders);\n  return orders.reduce((total, order) => {\n    const orderTotal = order.totalAmount || order.totalPrice || (order.items || []).reduce((sub, item) => sub + (item.totalPrice || 0), 0);\n    return total + orderTotal;\n  }, 0);\n};\n_s2(useTotalBillAmount, \"/BBlCk5bctNdc/53FtWqVYN7m+M=\", false, function () {\n  return [useCartStore];\n});\nexport const useSessionTotal = () => {\n  _s3();\n  const cartTotal = useCartTotalAmount();\n  const billTotal = useTotalBillAmount();\n  return billTotal + cartTotal;\n};\n_s3(useSessionTotal, \"VwCr9/7NowPEtsIIrUTUZIlnGM4=\", false, function () {\n  return [useCartTotalAmount, useTotalBillAmount];\n});\nexport default useCartStore;","map":{"version":3,"names":["create","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","generateOptionsKey","options","length","sorted","sort","a","b","nameA","name","nameB","localeCompare","JSON","stringify","useCartStore","set","get","cart","orders","menuData","menuLoading","error","fetchMenu","response","fetch","ok","Error","data","json","err","message","fetchMenuData","_arg","fetchOrders","tableNumber","currentOrders","console","addToCart","item","quantity","state","basePrice","Number","price","optionsPrice","reduce","sum","opt","unitPrice","currentOptionsKey","existingIndex","findIndex","c","id","selectedOptions","newCart","totalPrice","newItem","removeFromCart","index","filter","_","i","updateCartItemQuantity","clearCart","checkout","method","headers","body","alert","placeOrder","items","newOrder","callStaff","useCartTotalAmount","_s","useTotalBillAmount","_s2","total","order","orderTotal","totalAmount","sub","useSessionTotal","_s3","cartTotal","billTotal"],"sources":["C:/Users/arsuser/Documents/24A18/卒業研究/main/resto-app/src/store/cartStore.ts"],"sourcesContent":["import { create } from \"zustand\";\r\nimport { MenuItem, CartItem, Order, MenuData } from \"../types\";\r\n\r\n// 環境変数、またはデフォルトのIPアドレス（学校用に合わせてHTTPS/443にしています）\r\nconst API_BASE_URL =\r\n  process.env.REACT_APP_API_BASE_URL || \"https://localhost:443\";\r\n\r\ninterface CartState {\r\n  cart: CartItem[];\r\n  orders: Order[];\r\n  menuData: MenuData | null;\r\n  menuLoading: boolean;\r\n  error: string | null;\r\n\r\n  fetchMenu: () => Promise<void>;\r\n  fetchMenuData: (arg?: any) => Promise<void>;\r\n  fetchOrders: (tableNumber: number) => Promise<void>;\r\n  addToCart: (\r\n    item: MenuItem,\r\n    quantity: number,\r\n    options?: (string | { name: string; price: number })[]\r\n  ) => void;\r\n  removeFromCart: (index: number) => void;\r\n  updateCartItemQuantity: (index: number, quantity: number) => void;\r\n  placeOrder: (tableNumber: number) => Promise<Order | null>;\r\n  checkout: (tableNumber: number) => Promise<void>;\r\n  callStaff: (tableNumber: number) => Promise<void>;\r\n  clearCart: () => void;\r\n}\r\n\r\n// オプション配列をソートして一意なキーを作成するヘルパー\r\nconst generateOptionsKey = (\r\n  options: (string | { name: string; price: number })[]\r\n) => {\r\n  if (!options || options.length === 0) return \"\";\r\n  const sorted = [...options].sort((a, b) => {\r\n    const nameA = typeof a === \"string\" ? a : a.name;\r\n    const nameB = typeof b === \"string\" ? b : b.name;\r\n    return nameA.localeCompare(nameB);\r\n  });\r\n  return JSON.stringify(sorted);\r\n};\r\n\r\nconst useCartStore = create<CartState>((set, get) => ({\r\n  cart: [],\r\n  orders: [],\r\n  menuData: null,\r\n  menuLoading: false,\r\n  error: null,\r\n\r\n  fetchMenu: async () => {\r\n    set({ menuLoading: true, error: null });\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/api/menu`);\r\n      if (!response.ok) throw new Error(\"メニューの読み込みに失敗しました\");\r\n      const data = await response.json();\r\n      set({ menuData: data, menuLoading: false });\r\n    } catch (err: any) {\r\n      set({ error: err.message, menuLoading: false });\r\n    }\r\n  },\r\n\r\n  fetchMenuData: async (_arg?: any) => {\r\n    await get().fetchMenu();\r\n  },\r\n\r\n  fetchOrders: async (tableNumber: number) => {\r\n    try {\r\n      // サーバーから「会計済み」以外の注文だけを取得\r\n      const response = await fetch(\r\n        `${API_BASE_URL}/api/orders?tableNumber=${tableNumber}`\r\n      );\r\n      if (response.ok) {\r\n        const currentOrders: Order[] = await response.json();\r\n        set({ orders: currentOrders });\r\n      }\r\n    } catch (err) {\r\n      console.error(\"注文履歴の取得に失敗:\", err);\r\n    }\r\n  },\r\n\r\n  addToCart: (item, quantity, options = []) => {\r\n    set((state) => {\r\n      const basePrice = Number(item.price) || 0;\r\n      const optionsPrice = options.reduce((sum, opt) => {\r\n        if (typeof opt === \"object\" && opt !== null && \"price\" in opt) {\r\n          return sum + (Number(opt.price) || 0);\r\n        }\r\n        return sum;\r\n      }, 0);\r\n      const unitPrice = basePrice + optionsPrice;\r\n      const currentOptionsKey = generateOptionsKey(options);\r\n\r\n      const existingIndex = state.cart.findIndex(\r\n        (c) =>\r\n          c.id === item.id &&\r\n          generateOptionsKey(c.selectedOptions || []) === currentOptionsKey\r\n      );\r\n\r\n      if (existingIndex > -1) {\r\n        const newCart = [...state.cart];\r\n        newCart[existingIndex].quantity += quantity;\r\n        newCart[existingIndex].totalPrice =\r\n          unitPrice * newCart[existingIndex].quantity;\r\n        return { cart: newCart };\r\n      } else {\r\n        const newItem: CartItem = {\r\n          ...item,\r\n          quantity,\r\n          selectedOptions: options,\r\n          totalPrice: unitPrice * quantity,\r\n        };\r\n        return { cart: [...state.cart, newItem] };\r\n      }\r\n    });\r\n  },\r\n\r\n  removeFromCart: (index) => {\r\n    set((state) => ({\r\n      cart: state.cart.filter((_, i) => i !== index),\r\n    }));\r\n  },\r\n\r\n  updateCartItemQuantity: (index, quantity) => {\r\n    set((state) => {\r\n      const newCart = [...state.cart];\r\n      if (quantity <= 0) {\r\n        return { cart: newCart.filter((_, i) => i !== index) };\r\n      }\r\n      const item = newCart[index];\r\n      const basePrice = Number(item.price) || 0;\r\n      const optionsPrice = (item.selectedOptions || []).reduce(\r\n        (sum: number, opt: string | { name: string; price: number }) => {\r\n          if (typeof opt === \"object\" && opt !== null && \"price\" in opt) {\r\n            return sum + (Number(opt.price) || 0);\r\n          }\r\n          return sum;\r\n        },\r\n        0\r\n      );\r\n      newCart[index].quantity = quantity;\r\n      newCart[index].totalPrice = (basePrice + optionsPrice) * quantity;\r\n      return { cart: newCart };\r\n    });\r\n  },\r\n\r\n  clearCart: () => set({ cart: [] }),\r\n\r\n  /* ★ここが最重要修正ポイント！\r\n   サーバーのDBを更新しないとKDSから消えないので、必ずfetchを行います。\r\n  */\r\n  checkout: async (tableNumber: number) => {\r\n    try {\r\n      // 1. サーバーに「このテーブルは会計済みにして！」と頼む\r\n      const response = await fetch(`${API_BASE_URL}/api/checkout`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ tableNumber }),\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Checkout failed\");\r\n\r\n      // 2. サーバーでの更新が成功したら、タブレットの画面もクリアする\r\n      set({ cart: [], orders: [] });\r\n    } catch (error) {\r\n      console.error(\"Checkout error:\", error);\r\n      alert(\"通信エラーが発生しました。もう一度試してください。\");\r\n    }\r\n  },\r\n\r\n  placeOrder: async (tableNumber: number) => {\r\n    const { cart } = get();\r\n    if (cart.length === 0) return null;\r\n\r\n    try {\r\n      const response = await fetch(`${API_BASE_URL}/api/orders`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ tableNumber, items: cart }),\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"注文に失敗しました\");\r\n\r\n      const newOrder = await response.json();\r\n      set({ cart: [] });\r\n      await get().fetchOrders(tableNumber);\r\n      return newOrder;\r\n    } catch (err: any) {\r\n      set({ error: err.message });\r\n      return null;\r\n    }\r\n  },\r\n\r\n  callStaff: async (tableNumber: number) => {\r\n    try {\r\n      await fetch(`${API_BASE_URL}/api/call`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ tableNumber }),\r\n      });\r\n      await get().fetchOrders(tableNumber);\r\n    } catch (err) {\r\n      console.error(\"スタッフ呼び出しエラー\", err);\r\n    }\r\n  },\r\n}));\r\n\r\nexport const useCartTotalAmount = () => {\r\n  const cart = useCartStore((state) => state.cart);\r\n  return cart.reduce((sum, item) => sum + (item.totalPrice || 0), 0);\r\n};\r\n\r\nexport const useTotalBillAmount = () => {\r\n  const orders = useCartStore((state) => state.orders);\r\n  return orders.reduce((total, order) => {\r\n    const orderTotal =\r\n      order.totalAmount ||\r\n      order.totalPrice ||\r\n      (order.items || []).reduce(\r\n        (sub, item) => sub + (item.totalPrice || 0),\r\n        0\r\n      );\r\n    return total + orderTotal;\r\n  }, 0);\r\n};\r\n\r\nexport const useSessionTotal = () => {\r\n  const cartTotal = useCartTotalAmount();\r\n  const billTotal = useTotalBillAmount();\r\n  return billTotal + cartTotal;\r\n};\r\n\r\nexport default useCartStore;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}