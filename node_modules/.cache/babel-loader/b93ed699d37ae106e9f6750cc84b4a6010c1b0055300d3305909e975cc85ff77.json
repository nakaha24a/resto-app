{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\arsuser\\\\Documents\\\\24A18\\\\\\u5352\\u696D\\u7814\\u7A76\\\\main\\\\resto-app\\\\src\\\\components\\\\MenuItem.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport OptionModal from \"./OptionModal\";\nimport useCartStore from \"../store/cartStore\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const MenuItem = ({\n  item\n}) => {\n  _s();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const addToCart = useCartStore(state => state.addToCart);\n\n  // パソコンのIPアドレスがわかっている場合はそれに書き換えてください\n  // 例: \"http://192.168.1.15:3000\"\n  const API_BASE_URL = process.env.REACT_APP_API_BASE_URL || \"http://172.16.31.16:3000\";\n\n  // ★ここを修正：どんなパスが来ても確実に「assets」を含めたURLを作る\n  const getImageUrl = imagePath => {\n    if (!imagePath) return \"https://via.placeholder.com/300x200?text=No+Image\";\n\n    // すでにhttpがついている完全なURLならそのまま返す\n    if (imagePath.startsWith(\"http\")) return imagePath;\n\n    // 先頭の / を削除してきれいにする\n    let cleanPath = imagePath.startsWith(\"/\") ? imagePath.slice(1) : imagePath;\n\n    // ★ここが重要修正ポイント★\n    // パスの中に「assets」も「static」も含まれていなければ、「assets/」を先頭に足す\n    if (!cleanPath.startsWith(\"assets/\") && !cleanPath.startsWith(\"static/\")) {\n      cleanPath = `assets/${cleanPath}`;\n    }\n    return `${API_BASE_URL}/${cleanPath}`;\n  };\n  const handleItemClick = () => {\n    // ★修正: オプションの有無に関わらず、常にモーダルを開くように変更\n    // これにより、すべての商品で「詳細確認 → 個数選択 → カート追加」の流れに統一されます\n    setIsModalOpen(true);\n  };\n  const handleModalConfirm = (quantity, selectedOptions) => {\n    addToCart(item, quantity, selectedOptions);\n    setIsModalOpen(false);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"menu-item\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"menu-item-clickable\",\n        onClick: handleItemClick,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"100%\",\n            height: \"180px\",\n            overflow: \"hidden\",\n            flexShrink: 0\n          },\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: getImageUrl(item.image),\n            alt: item.name,\n            className: \"menu-image\",\n            style: {\n              width: \"100%\",\n              height: \"100%\",\n              objectFit: \"cover\",\n              display: \"block\"\n            },\n            onError: e => {\n              // エラーになったらconsoleに実際のURLを出して確認できるようにする\n              console.error(\"画像読み込み失敗:\", e.target.src);\n              e.target.src = \"https://via.placeholder.com/300x200?text=No+Image\";\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"menu-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"menu-name\",\n            children: item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"menu-description\",\n            children: item.description || \"美味しいメニューです。\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this), item.allergens && item.allergens.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"menu-allergens\",\n            children: [\"\\u30A2\\u30EC\\u30EB\\u30AE\\u30FC: \", item.allergens.join(\", \")]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"menu-price\",\n            children: [\"\\xA5\", item.price.toLocaleString()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(OptionModal, {\n      menuItem: item,\n      isOpen: isModalOpen,\n      onClose: () => setIsModalOpen(false),\n      onConfirm: handleModalConfirm\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(MenuItem, \"c0siqVf7PY1lDWKtfsxOGnCAPlw=\", false, function () {\n  return [useCartStore];\n});\n_c = MenuItem;\nvar _c;\n$RefreshReg$(_c, \"MenuItem\");","map":{"version":3,"names":["React","useState","OptionModal","useCartStore","jsxDEV","_jsxDEV","Fragment","_Fragment","MenuItem","item","_s","isModalOpen","setIsModalOpen","addToCart","state","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","getImageUrl","imagePath","startsWith","cleanPath","slice","handleItemClick","handleModalConfirm","quantity","selectedOptions","children","className","onClick","style","width","height","overflow","flexShrink","src","image","alt","name","objectFit","display","onError","e","console","error","target","fileName","_jsxFileName","lineNumber","columnNumber","description","allergens","length","join","price","toLocaleString","menuItem","isOpen","onClose","onConfirm","_c","$RefreshReg$"],"sources":["C:/Users/arsuser/Documents/24A18/卒業研究/main/resto-app/src/components/MenuItem.tsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { MenuItem as MenuItemType } from \"../types\";\r\nimport OptionModal from \"./OptionModal\";\r\nimport useCartStore from \"../store/cartStore\";\r\n\r\ninterface MenuItemProps {\r\n  item: MenuItemType;\r\n}\r\n\r\nexport const MenuItem: React.FC<MenuItemProps> = ({ item }) => {\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const addToCart = useCartStore((state) => state.addToCart);\r\n\r\n  // パソコンのIPアドレスがわかっている場合はそれに書き換えてください\r\n  // 例: \"http://192.168.1.15:3000\"\r\n  const API_BASE_URL =\r\n    process.env.REACT_APP_API_BASE_URL || \"http://172.16.31.16:3000\";\r\n\r\n  // ★ここを修正：どんなパスが来ても確実に「assets」を含めたURLを作る\r\n  const getImageUrl = (imagePath: string | undefined) => {\r\n    if (!imagePath) return \"https://via.placeholder.com/300x200?text=No+Image\";\r\n\r\n    // すでにhttpがついている完全なURLならそのまま返す\r\n    if (imagePath.startsWith(\"http\")) return imagePath;\r\n\r\n    // 先頭の / を削除してきれいにする\r\n    let cleanPath = imagePath.startsWith(\"/\") ? imagePath.slice(1) : imagePath;\r\n\r\n    // ★ここが重要修正ポイント★\r\n    // パスの中に「assets」も「static」も含まれていなければ、「assets/」を先頭に足す\r\n    if (!cleanPath.startsWith(\"assets/\") && !cleanPath.startsWith(\"static/\")) {\r\n      cleanPath = `assets/${cleanPath}`;\r\n    }\r\n\r\n    return `${API_BASE_URL}/${cleanPath}`;\r\n  };\r\n\r\n  const handleItemClick = () => {\r\n    // ★修正: オプションの有無に関わらず、常にモーダルを開くように変更\r\n    // これにより、すべての商品で「詳細確認 → 個数選択 → カート追加」の流れに統一されます\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleModalConfirm = (quantity: number, selectedOptions: string[]) => {\r\n    addToCart(item, quantity, selectedOptions);\r\n    setIsModalOpen(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"menu-item\">\r\n        <div className=\"menu-item-clickable\" onClick={handleItemClick}>\r\n          <div\r\n            style={{\r\n              width: \"100%\",\r\n              height: \"180px\",\r\n              overflow: \"hidden\",\r\n              flexShrink: 0,\r\n            }}\r\n          >\r\n            <img\r\n              src={getImageUrl(item.image)}\r\n              alt={item.name}\r\n              className=\"menu-image\"\r\n              style={{\r\n                width: \"100%\",\r\n                height: \"100%\",\r\n                objectFit: \"cover\",\r\n                display: \"block\",\r\n              }}\r\n              onError={(e) => {\r\n                // エラーになったらconsoleに実際のURLを出して確認できるようにする\r\n                console.error(\r\n                  \"画像読み込み失敗:\",\r\n                  (e.target as HTMLImageElement).src\r\n                );\r\n                (e.target as HTMLImageElement).src =\r\n                  \"https://via.placeholder.com/300x200?text=No+Image\";\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"menu-info\">\r\n            <div className=\"menu-name\">{item.name}</div>\r\n            <div className=\"menu-description\">\r\n              {item.description || \"美味しいメニューです。\"}\r\n            </div>\r\n            {item.allergens && item.allergens.length > 0 && (\r\n              <div className=\"menu-allergens\">\r\n                アレルギー: {item.allergens.join(\", \")}\r\n              </div>\r\n            )}\r\n            <div className=\"menu-price\">¥{item.price.toLocaleString()}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <OptionModal\r\n        menuItem={item}\r\n        isOpen={isModalOpen}\r\n        onClose={() => setIsModalOpen(false)}\r\n        onConfirm={handleModalConfirm}\r\n      />\r\n    </>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}